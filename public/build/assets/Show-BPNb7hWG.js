import{j as e,c as w,u as k,H as z,L as y,r as u,a as j}from"./app-BkrwjwnH.js";import{G as B}from"./GuestLayout-s7qvGj1K.js";import{A as C}from"./index-BYwxAwIE.js";import{m as h}from"./proxy-CjKYYJ4f.js";import{T as U}from"./triangle-alert-CuVReVTr.js";import{A as F}from"./arrow-left-DB9S5MZo.js";import{M as $}from"./message-circle-hDzUgawl.js";import{S as E}from"./send-DqePMcy4.js";import{c as S}from"./createLucideIcon-BSUppqDf.js";import{M as G}from"./message-square-C5029JuS.js";import{f as O}from"./formatDistanceToNow-BQf_XZYy.js";const V=[["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}],["path",{d:"M7 10v12",key:"1qc93n"}]],v=S("thumbs-up",V);const Z=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],J=S("trash-2",Z),K=({isOpen:t,onClose:o,onConfirm:a,isDeleting:s,type:l="comment"})=>{const i=l.charAt(0).toUpperCase()+l.slice(1);return e.jsx(C,{children:t&&e.jsxs(e.Fragment,{children:[e.jsx(h.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:o,className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-[60]"}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-[70] p-4 pointer-events-none",children:e.jsxs(h.div,{initial:{opacity:0,scale:.95,y:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:10},className:"bg-white rounded-xl shadow-2xl w-full max-w-sm overflow-hidden pointer-events-auto border border-gray-100",children:[e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"shrink-0 w-10 h-10 rounded-full bg-red-100 flex items-center justify-center text-red-600",children:e.jsx(U,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900",children:["Delete ",i,"?"]}),e.jsxs("p",{className:"mt-2 text-sm text-gray-500 leading-relaxed",children:["Are you sure you want to delete this ",l,"? This action cannot be undone."]})]})]})}),e.jsxs("div",{className:"bg-gray-50 px-6 py-4 flex gap-3 justify-end border-t border-gray-100",children:[e.jsx("button",{onClick:o,disabled:s,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-200 transition-colors disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:a,disabled:s,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors shadow-sm disabled:opacity-70 flex items-center gap-2",children:s?"Deleting...":"Delete"})]})]})})]})})};function N(t){try{if(!t)return"";t=t.replace(/<(script|style)[^>]*>[\s\S]*?<\/(script|style)>/gi,"");const o=["p","br","b","strong","i","em","u","ul","ol","li","span","blockquote","code","pre","h1","h2","h3","h4","h5","h6"];return t.replace(/<([^>]+)>/g,(a,s)=>{const l=s.split(" ")[0].replace(/\//g,"").toLowerCase();return o.includes(l)?a:""})}catch{return t}}const _=({comment:t,postId:o,depth:a=0})=>{const{auth:s}=w().props,[l,i]=u.useState(!1),[g,p]=u.useState(!0),[b,n]=u.useState(!1),[m,r]=u.useState(!1),{data:c,setData:M,post:D,processing:A,reset:L}=k({comment:"",parent_id:t.id}),q=d=>{d.preventDefault(),D(route("comments.store",o),{onSuccess:()=>{i(!1),L(),p(!0)},preserveScroll:!0})},R=()=>{s.user&&j.post(route("comments.like",t.id),{},{preserveScroll:!0})},T=()=>{n(!0)},P=()=>{r(!0),j.delete(route("comments.destroy",t.id),{preserveScroll:!0,onFinish:()=>{r(!1),n(!1)}})},x=t.user?t.user.name:"Anonymous",f=t.user?t.user.avatar:null,H=x.charAt(0).toUpperCase(),I=s.user&&t.user&&s.user.id===t.user.id;return e.jsxs("div",{className:"group relative",children:[e.jsxs("div",{className:"flex gap-3 items-start",children:[e.jsx("div",{className:"shrink-0",children:f?e.jsx("img",{src:f,alt:x,className:"w-8 h-8 md:w-10 md:h-10 rounded-full object-cover border border-gray-200"}):e.jsx("div",{className:"w-8 h-8 md:w-10 md:h-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-bold text-xs md:text-sm border-2 border-white",children:H})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"bg-gray-50/50 p-3 rounded-2xl rounded-tl-none border border-gray-100 hover:border-gray-200 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h4",{className:"font-bold text-gray-900 text-sm truncate",children:x}),e.jsx("span",{className:"text-xs text-gray-400 whitespace-nowrap ml-2",children:t.created_at?O(new Date(t.created_at)):""})]}),e.jsx("p",{className:"text-gray-700 text-sm leading-relaxed whitespace-pre-wrap break-words",children:t.comment})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-1 ml-2",children:[s.user?e.jsxs("button",{onClick:R,className:`flex items-center gap-1.5 text-xs font-medium transition-colors ${t.is_liked?"text-blue-600":"text-gray-500 hover:text-gray-800"}`,children:[e.jsx(v,{className:`w-3.5 h-3.5 ${t.is_liked?"fill-current":""}`}),e.jsx("span",{children:t.likes_count>0?t.likes_count:"Like"})]}):e.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-medium text-gray-400",title:"Log in to like",children:[e.jsx(v,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:t.likes_count>0?t.likes_count:"0"})]}),s.user&&a===0&&e.jsxs("button",{onClick:()=>i(!l),className:"flex items-center gap-1.5 text-xs font-medium text-gray-500 hover:text-gray-800 transition-colors",children:[e.jsx(G,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:"Reply"})]}),I&&e.jsxs("button",{onClick:T,className:"flex items-center gap-1.5 text-xs font-medium text-gray-400 hover:text-red-600 transition-colors ml-auto md:ml-0",title:"Delete comment",children:[e.jsx(J,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:"Delete"})]})]}),e.jsx(C,{children:l&&e.jsx(h.form,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-3 overflow-hidden",onSubmit:q,children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"w-0.5 bg-gray-200 mb-2 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("textarea",{value:c.comment,onChange:d=>M("comment",d.target.value),placeholder:`Replying to ${x}...`,className:"w-full p-2 text-sm border-gray-200 rounded-lg focus:border-blue-500 focus:ring-blue-500 bg-white",rows:2,autoFocus:!0}),e.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[e.jsx("button",{type:"button",onClick:()=>i(!1),className:"px-3 py-1 text-xs font-medium text-gray-500 hover:text-gray-700",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:A||!c.comment.trim(),className:"px-3 py-1 bg-blue-600 text-white text-xs font-medium rounded-md hover:bg-blue-700 disabled:opacity-50",children:"Post Reply"})]})]})]})})})]})]}),t.replies&&t.replies.length>0&&e.jsxs("div",{className:"mt-3 pl-4 md:pl-6 relative",children:[e.jsx("div",{className:"absolute left-[20px] md:left-[28px] top-0 bottom-0 w-px bg-gray-200 -z-10"}),e.jsx("div",{className:"flex flex-col gap-4",children:t.replies.map(d=>e.jsx(_,{comment:d,postId:o,depth:a+1},d.id))})]}),e.jsx(K,{isOpen:b,onClose:()=>n(!1),onConfirm:P,isDeleting:m,type:a>0?"reply":"comment"})]})};function ie({post:t,readTime:o}){const{auth:a}=w().props,{data:s,setData:l,post:i,processing:g,reset:p}=k({comment:"",parent_id:null}),b=()=>{i(route("comments.store",t.id),{onSuccess:()=>p(),preserveScroll:!0})},n=Array.isArray(t.body)?t.body:[],m="blog-content text-gray-800 leading-relaxed [&>h1]:text-4xl [&>h1]:font-bold [&>h1]:text-gray-900 [&>h1]:mb-6 [&>h1]:mt-8 [&>h2]:text-3xl [&>h2]:font-semibold [&>h2]:text-gray-900 [&>h2]:mb-5 [&>h2]:mt-7 [&>h3]:text-2xl [&>h3]:font-semibold [&>h3]:text-gray-900 [&>h3]:mb-4 [&>h3]:mt-6 [&>p]:mb-4 [&>p]:leading-relaxed [&>ul]:mb-4 [&>ul]:ml-6 [&>ul]:list-disc [&>ol]:mb-4 [&>ol]:ml-6 [&>ol]:list-decimal [&>li]:mb-2 [&>blockquote]:border-l-4 [&>blockquote]:border-blue-500 [&>blockquote]:bg-blue-50 [&>blockquote]:py-4 [&>blockquote]:px-6 [&>blockquote]:my-6 [&>blockquote]:italic [&>code]:bg-gray-100 [&>code]:px-2 [&>code]:py-1 [&>code]:rounded [&>code]:text-sm [&>code]:font-mono [&>pre]:bg-gray-900 [&>pre]:text-gray-100 [&>pre]:p-4 [&>pre]:rounded-lg [&>pre]:overflow-x-auto [&>pre]:my-6 [&>strong]:font-semibold [&>em]:italic [&>u]:underline";return e.jsxs(B,{children:[e.jsx(z,{title:t.title}),e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("article",{className:"relative max-w-3xl md:max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 pt-12 md:pt-16 pb-20",children:[e.jsx(h.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"mb-8 md:mb-10",children:e.jsxs(y,{href:route("blog.index"),className:"inline-flex items-center text-gray-600 hover:text-blue-600 transition-colors",children:[e.jsx(F,{className:"w-4 h-4 mr-2"})," Back to Blog"]})}),e.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-sm mb-12",children:[e.jsx("h1",{className:"text-3xl md:text-5xl font-bold text-gray-900 mb-6",children:t.title}),(!n||n.length===0)&&t.content?e.jsx("div",{className:m,dangerouslySetInnerHTML:{__html:N(t.content)}}):n.map((r,c)=>e.jsx("div",{className:"mb-6",children:r.type==="text"?e.jsx("div",{className:m,dangerouslySetInnerHTML:{__html:N(r.content)}}):r.type==="image"?e.jsx("img",{src:r.content,className:"w-full rounded-lg"}):null},c))]}),e.jsxs("div",{className:"border-t border-gray-200 pt-8",children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-6 flex items-center",children:[e.jsx($,{className:"w-5 h-5 mr-2"}),"Comments (",t.comments?t.comments.reduce((r,c)=>r+1+(c.replies?.length||0),0):0,")"]}),a.user?e.jsxs("div",{className:"mb-8 bg-gray-50 rounded-lg p-4 flex gap-4 border border-gray-100",children:[e.jsx("div",{className:"shrink-0",children:a.user.avatar?e.jsx("img",{src:a.user.avatar,alt:a.user.name,className:"w-10 h-10 rounded-full object-cover border border-gray-200"}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-bold text-sm border-2 border-white",children:a.user.name.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("textarea",{value:s.comment,onChange:r=>l("comment",r.target.value),placeholder:"Share your thoughts...",className:"w-full p-3 border border-gray-200 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",rows:3}),e.jsx("div",{className:"flex justify-end mt-3",children:e.jsxs("button",{onClick:b,disabled:!s.comment.trim()||g,className:"inline-flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md text-sm font-medium transition-colors disabled:opacity-50",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),g?"Posting...":"Post Comment"]})})]})]}):e.jsx("div",{className:"mb-8 bg-gray-50 rounded-lg p-6 text-center border border-gray-100",children:e.jsxs("p",{className:"text-gray-600",children:["Please ",e.jsx(y,{href:route("login"),className:"text-blue-600 hover:underline font-medium",children:"log in"})," to join the discussion."]})}),e.jsxs("div",{className:"space-y-4",children:[t.comments&&t.comments.map(r=>e.jsx(_,{comment:r,postId:t.id},r.id)),(!t.comments||t.comments.length===0)&&e.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-50 rounded-lg border border-dashed border-gray-200",children:"No comments yet. Be the first to share your thoughts!"})]})]})]})})]})}export{ie as default};
