import{r as i,a as x,j as e,H as _,L as f}from"./app-BeIANDLY.js";import{A as $}from"./AdminLayout-DccdcQcm.js";import{l as M}from"./lodash-B3djzXDO.js";import"./chevron-left-BPgW5mis.js";import"./createLucideIcon-Tx3b3-vc.js";function E({auth:j,tickets:n,filters:m,statuses:d}){const[l,c]=i.useState({search:m.search||"",status:m.status||""}),[b,u]=i.useState(!1),[a,o]=i.useState(null),N=i.useCallback(M.debounce((s,t)=>{x.get(route("admin.support.index"),{search:s,status:t},{preserveState:!0,preserveScroll:!0,replace:!0})},300),[]),v=s=>{const t=s.target.value;c(r=>({...r,search:t})),N(t,l.status)},w=s=>{const t=s.target.value;c(r=>({...r,status:t})),x.get(route("admin.support.index"),{search:l.search,status:t},{preserveState:!0,preserveScroll:!0,replace:!0})},p=(s,t)=>{!t||t===s.status||x.patch(route("admin.support.updateStatus",s.id),{status:t},{preserveScroll:!0})},S=s=>{o(s),u(!0)},h=()=>{u(!1),setTimeout(()=>o(null),200)},g=s=>{switch(s?.toLowerCase()){case"high":return"bg-red-100 text-red-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},y=s=>{switch(s?.toLowerCase()){case"open":return"bg-blue-100 text-blue-800";case"pending":return"bg-orange-100 text-orange-800";case"resolved":return"bg-green-100 text-green-800";case"closed":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs($,{user:j.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Support Tickets"}),children:[e.jsx(_,{title:"Support Tickets"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6 text-gray-900",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"All Tickets"}),e.jsxs("div",{className:"flex flex-col items-end w-full md:w-auto gap-2",children:[e.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[e.jsxs("select",{className:"border-gray-300 rounded-md shadow-sm capitalize w-32 focus:border-indigo-500 focus:ring-indigo-500",value:l.status,onChange:w,children:[e.jsx("option",{value:"",children:"All Status"}),d.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsx("input",{type:"text",placeholder:"Search subject, user...",className:"border-gray-300 rounded-md shadow-sm w-full md:w-64 focus:border-indigo-500 focus:ring-indigo-500",value:l.search,onChange:v})]}),(l.search||l.status)&&e.jsx(f,{href:route("admin.support.index"),className:"text-xs text-gray-500 hover:text-gray-800 underline",onClick:()=>c({search:"",status:""}),children:"Clear Filters"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Subject"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Details"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Action"})]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[n.data.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-indigo-100 flex items-center justify-center mr-3 text-indigo-700 text-xs font-bold uppercase",children:s.user?.name.charAt(0)||"?"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.user?.name||"Unknown User"}),e.jsx("div",{className:"text-sm text-gray-500",children:s.user?.email})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900 font-medium truncate w-48",title:s.subject,children:s.subject})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:["Cat: ",s.category]}),e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium w-fit ${g(s.priority)}`,children:s.priority})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${y(s.status)}`,children:s.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(s.created_at).toLocaleDateString("en-GB")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("select",{className:"text-xs border-gray-300 rounded-md shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50 py-1 cursor-pointer",value:s.status,onChange:t=>p(s,t.target.value),children:d.map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsx("button",{onClick:()=>S(s),className:"px-3 py-1 bg-indigo-600 hover:bg-indigo-700 text-white rounded text-xs font-semibold shadow-sm transition",children:"View"})]})})]},s.id)),n.data.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-4 text-center text-gray-500",children:"No support tickets found."})})]})]})}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-1",children:n.links.map((s,t)=>{const r="px-3 py-1 border rounded text-sm transition-colors duration-150",C="bg-indigo-600 text-white border-indigo-600",T="bg-white text-gray-700 border-gray-300 hover:bg-gray-50",L="text-gray-400 bg-gray-100 border-gray-200 cursor-not-allowed";return s.url?e.jsx(f,{href:s.url,className:`${r} ${s.active?C:T}`,dangerouslySetInnerHTML:{__html:s.label},preserveState:!0,preserveScroll:!0},t):e.jsx("span",{className:`${r} ${L}`,dangerouslySetInnerHTML:{__html:s.label}},t)})})]})})})}),b&&a&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:e.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:h}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"â€‹"}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[e.jsx("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("h3",{className:"text-lg leading-6 font-medium text-gray-900",id:"modal-title",children:["Ticket #",a.id]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("select",{className:"text-xs border-gray-300 rounded-md shadow-sm py-1",value:a.status,onChange:s=>{const t=s.target.value;p(a,t),o(r=>({...r,status:t}))},children:d.map(s=>e.jsx("option",{value:s,children:s},s))}),e.jsx("span",{className:`px-2 inline-flex items-center text-xs leading-5 font-semibold rounded-full ${y(a.status)}`,children:a.status})]})]}),e.jsxs("div",{className:"mt-4 border-t border-gray-100 pt-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase font-bold",children:"User"}),e.jsx("p",{className:"text-sm text-gray-900",children:a.user?.name}),e.jsx("p",{className:"text-xs text-gray-400",children:a.user?.email})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase font-bold",children:"Submitted"}),e.jsx("p",{className:"text-sm text-gray-900",children:new Date(a.created_at).toLocaleString("en-GB")})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase font-bold",children:"Category"}),e.jsx("p",{className:"text-sm text-gray-900",children:a.category})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase font-bold",children:"Priority"}),e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium mt-1 ${g(a.priority)}`,children:a.priority})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase font-bold",children:"Subject"}),e.jsx("p",{className:"text-sm text-gray-900 font-medium",children:a.subject})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase font-bold mb-1",children:"Message Description"}),e.jsx("div",{className:"bg-gray-50 p-4 rounded text-sm text-gray-800 whitespace-pre-wrap border border-gray-100 max-h-60 overflow-y-auto",children:a.message})]})]})]})})}),e.jsx("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:e.jsx("button",{type:"button",onClick:h,className:"w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Close"})})]})]})})]})}export{E as default};
